# Customer-segmentation-with-hierarchical-clustering-and-KNN
This project establishes a customer segmentation system designed to handle real-world data imbalances. Standard clustering algorithms often dump the majority of customers into one massive "Average" group while isolating a few "VIPs." This system solves that problem using a multi-stage recursive approach.
1. Data Transformation & Cleaning The system does not analyze raw sales transactions directly. Instead, it first compiles a profile for every unique customer based on two critical metrics: Monetary (total money spent) and Frequency (total number of purchases). Before analysis, the system applies a statistical filter to remove the top 1% of extreme outliers ("whales"), ensuring that a few massive spenders do not distort the mathematical model for everyone else.

2. Level 1: Global Clustering (The Macro View) The system applies Agglomerative Hierarchical Clustering to the entire customer base. In this first pass, the algorithm successfully identifies and isolates the "High-Value" (Elite) customers because their behavior is drastically different from the norm. However, this leaves a large, unrefined block of "Standard" customers grouped together. The system detects this imbalance automatically.

3. Level 2: Recursive Clustering (The Micro View) This is the system's core innovation. Instead of accepting the large "Standard" block as a single segment, the code isolates this specific group of data and runs the clustering algorithm a second time only on them. By zooming in on this crowded group, the system discovers hidden patterns that were previously invisible. It successfully splits the "Standard" group into two meaningful sub-segments: "Loyal Regulars" and "Low-Value/At-Risk" customers.

4. The Hybrid Prediction Engine (KNN) Once the recursive process has finalized the three distinct segments (Elite, Loyal, At-Risk), the system switches from analysis to prediction. It uses these final labels to train a K-Nearest Neighbors (KNN) classifier. This effectively "memorizes" the mathematical boundaries of the segments.

Conclusion The result is a system that offers the best of both worlds: the deep analytical capability to find hidden subgroups within crowded data, and the speed to classify new customers instantly using the trained KNN model.
